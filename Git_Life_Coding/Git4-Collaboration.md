# Git4



### 인트로

깃은 여러 저장소를 연결시켜 작업을 할 수 있다. 즉 다른 사람들이 각각의 저장소에서 작업하여 하나의 저장소를 합치는 작업을 할 수 있다. 이 경우 브랜치가 사용된다. 





### 혼자 작업 하기

버전을 만들어서 계속 작업을 한 뒤 백업을 하기 위해 원격저장소에 푸쉬를 한다.

또한 처음 푸쉬를 할 때 지역저장소의 마스터와 원격저장소의 마스터를 직접 페어링 해야 한다.

그 때 명령어는 다음과 같다. 

```powershell
git push -u origin master
```

지역 저장소와 원격 저장소의 브랜치가 페어링 되면서 푸쉬 된다.





### 같이 작업 하기

함께 작업을 할 경우 양쪽 다 승인을 해야 업로드가 가능하다.

깃헙 사이트에서 프로젝트의 collaborators에 github아이디를 추가한다. 그러면 추가가 된 아이디는 프로젝트에 참여할 수 있게 된다.





### push & pull

한 컴퓨터에서 작업을 한 뒤 커밋을 찍고 푸쉬한다.

다른 컴퓨터는 제대로 하려면 항상 pull을 받은 뒤 새로운 버전에서 작업을 해야 하는 데 그를 하지 않고 똑같은 부분을 수정한뒤 커밋을 찍어 push 한다고 해보자.

그러면 git이 rejected를 한다. 에러 내용은 원격저장소에 다른 사람이 작업한 내용이 있는 데 Pull을 하지 않았기 때문에 거절 된다고 뜨게 된다. 그래서 pull 명령으로 가져오고 push를 해야 한다.

그래서 pull을 하면 에러가 발생한다. 동일한 부분이 달라 충돌이 발생한다. 그래서 머징을 사용해야 한다. 에러가 난 파일을 들어가 어떤 브랜치의 내용을 선택하고 git add 명령과 commit명령을 통해 커밋 메시지로 문제를 해결했다는 메시지를 적어 머징을 완료한다. 

그리고 git push를 하게되면 원격 저장소로 완료된다.

최대한 작업을 자주 끝내고 푸쉬를 자주해야 충돌이 잘 나지 않는다. 그리고 푸쉬 한 내용을 자주 보는 것이 중요하다.





### 원격 브랜치와 fetch

우리는 pull commit push의 과정을 거쳤다.

하지만 pull을 하는 대신에 fetch를 하고 merge FETCH_HEAD를 통해 git push와 똑같은 이를 할 수 있다.

`git l`에서 origin/master는 원격저장소 origin의 master브랜치를 말한다.

만약 여기에서 commit을 찍으면 로컬에서 마스터는 내가 찍은 커밋을 가리키지만 원격저장소의 master는 이전의 커밋을 가리킨다. 

그렇다면 git status를 ㅉ기어보면 내 브랜치가 origin/master보다 한 커밋 앞서나간다는 메시지가 뜬다. 따라서 push를 하라는 메시지가 뜬다.

push를 하고 `git l`을 하면 origin/master와 local/master가 같은 커밋을 가리키는 것을 확인할 수 있다.



다른 컴퓨터에서 pull을 통해 땡겨올 수 있지만 `git fetch`를 통해 땡겨올 수 있다.

하지만 다른 컴퓨터에서 한 작업 내용은 보이지 않는다. 

fetch 명령으로 땡겨온 커밋은 자료는 정상적으로 가져오지만 내 로컬저장소의 마스터는 내 로컬 저장소의 최신 커밋을 가리킨다.

`git status`를 해보면 나의 브랜치가 origin/master보다 몇 커밋 뒤쳐저 있으며 fast-forwareded 될 수 있다고 한다. 해결방법은 pull을 하거나 현재 브랜치와 origin/master를 머지해도 된다.

```
git merge origin/master
```

이러면 git pull을 한 것과 같은 결과를 가지게 된다.



git pull은 git fetch 후에 git merge origin/master와 같은 결과를 가진다.

그런데 어떤 브랜치와 머지할 것인지 신경 쓰는 것은 상당히 귀찮은 일이다. 

git은 fetch를 할 때마다 .git 폴더안에 .git/FETCH_HEAD라는 폴더를 만든다.

FETCH_HEAD에는 커밋아이디가 들어있고 

```powershell
git fetch; git merge FETCH_HEAD
```

하면 가장 최근에 fetch했었던 커밋과 merge해준다.

즉 git fetch는 remote branch만 가져오는 명령어이다. 그리고 지역 브랜치와 원격 브랜치를 머지하는 방법을 고려해보았다.

결합은 나중에 하고 일단 가져오는 것부터 할 경우 이것을 사용한다.





### 수업을 마치며

코드 리뷰 : 코드 리뷰에는 gerrit같은 도구가 존재한다. 코드 품질을 상호검증하는 것인데 작업한 내용이 바로 올라가는 것이 아니라 투표소로 올라가고 투표를 통해 그 버전이 괜찮은지 개선점이 있을 수 있는지 확인한다.

깃헙이나 깃랩같은 깃 호스팅 서비스는 이슈 트래커를 제공하여 팀원 간의 커뮤니케이션을 제공한다.

인사이트 같은 통계를 보면 업무가 얼마나 활발하게 일어나는 지 확인할 수 있다. 

